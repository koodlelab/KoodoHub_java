<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="
      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
      http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd">

  <global-method-security secured-annotations="enabled"
                          authentication-manager-ref="KoodoAuthenticationManager" proxy-target-class="true"/>
  <http
      realm="Protected API"
      use-expressions="true"
      auto-config="false"
      create-session="stateless"
      entry-point-ref="UnauthorizedEntryPoint"
      authentication-manager-ref="KoodoAuthenticationManager">
      <custom-filter ref="AuthenticationTokenProcessingFilter" position="FORM_LOGIN_FILTER" />
    <intercept-url pattern="/services/session/authenticate" access="permitAll" />
    <intercept-url method="GET" pattern="/services/members/**" access="hasRole('MEMBER')" />
    <!--<intercept-url method="PUT" pattern="/rest/news/**" access="hasRole('admin')" />-->
    <!--<intercept-url method="POST" pattern="/rest/news/**" access="hasRole('admin')" />-->
    <!--<intercept-url method="DELETE" pattern="/rest/news/**" access="hasRole('admin')" />-->
  </http>

</beans:beans>